# 📘 הוראות שימוש פשוטות - ללא Google Cloud Console

## 🎯 פתרון מהיר ופשוט - רק Apps Script!

**לא צריך:**
- ❌ Google Cloud Console
- ❌ Python
- ❌ credentials.json
- ❌ התקנות מורכבות

**צריך רק:**
- ✅ חשבון Google
- ✅ 5 דקות

---

## 🚀 הוראות שימוש - צעד אחר צעד

### שלב 1: פתיחת Apps Script (1 דקה)
1. לך ל-https://script.google.com/
2. התחבר עם חשבון Google שלך
3. לחץ על **"+ New project"** (פרויקט חדש) למעלה משמאל

### שלב 2: העתקת הקוד (1 דקה)
1. פתח את הקובץ **`apscript_complete.js`** מהתיקייה שלך
2. העתק את **כל התוכן** (Ctrl+A, Ctrl+C)
3. חזור ל-Apps Script והדבק (Ctrl+V)

### שלב 3: עריכת השאלון (אופציונלי - אם רוצים לשנות)
1. בתוך הקוד, מצא את המשתנה `QUESTIONNAIRE_TEXT`
2. בין הסימנים `` ` `` (backticks), יש את השאלון הנוכחי
3. אם רוצים - ערוך את השאלון לפי הפורמט:
   ```
   Q1. השאלה שלך?
   A1. תשובה 1
   A2. תשובה 2
   A3. תשובה 3
   A4. תשובה 4

   Q2. שאלה נוספת?
   ...
   ```

### שלב 4: שמירה והרצה (1 דקה)
1. לחץ על **"Save"** (שמור) או Ctrl+S
2. אם תתבקש לתת שם לפרויקט:
   - הכנס שם (למשל: "Create Questionnaire Form")
   - לחץ **"OK"**

### שלב 5: הרצת הפונקציה (2 דקות)
1. בראש הדף, תראה רשימה נפתחת (dropdown) עם שם פונקציה
2. לחץ על הרשימה ובחר **`createFormFromText`**
3. לחץ על כפתור **"Run"** (▶) בצד

### שלב 6: אישור הרשאות (פעם אחת בלבד)
1. יופיע חלון **"Authorization required"**
2. לחץ על **"Review permissions"** (סקור הרשאות)
3. בחר את חשבון Google שלך
4. ייתכן שתקבל אזהרה **"This app isn't verified"**:
   - זה נורמלי - לחץ על **"Advanced"** (מתקדם)
   - לחץ על **"Go to [שם הפרויקט] (unsafe)"**
5. לחץ **"Allow"** (אפשר) לאשר את ההרשאות

### שלב 7: תוצאה!
1. **העתק את הקישורים מהיומן (Execution log):**
   - בתחתית חלון Apps Script, לחץ על **"Execution log"** (יומן ביצוע)
   - תראה הודעה עם 2 קישורים:
     - **📊 Google Sheet** - השיטס עם כל השאלות
     - **📝 Google Form** - הטופס המוכן לשימוש!
   - העתק את הקישורים (לחיצה ימנית → Copy)
2. **או פתח מה-Sheet:**
   - הקישורים נשמרו גם ב-Google Sheet:
     - עמודה **J** (10): קישור הפורם
     - עמודה **K** (11): Form ID
3. ייתכן שיופיע חלון הודעה (אם הדפדפן מאפשר) - לחץ **OK**

---

## ✅ מה נוצר?
- ✅ **Google Sheet** עם כל השאלות והתשובות בפורמט מובנה
- ✅ **Google Form** מוכן לשימוש עם כל השאלות והתשובות
- ✅ הקישורים נשמרים גם ב-Google Sheet (עמודות J ו-K)

---

## 🔄 אם רוצים לקרוא שאלון מקובץ Drive

### אופציה נוספת: קריאה מקובץ טקסט ב-Drive
1. העלה קובץ טקסט (`.txt`) ל-Google Drive
2. בקוד Apps Script, הרץ את הפונקציה:
   ```javascript
   createFormFromDriveFile('שם_הקובץ.txt')
   ```
3. הפונקציה תחפש את הקובץ ב-Drive ותיצור Sheet + Form

---

## ⚠️ פתרון בעיות

### בעיה: "Authorization required" לא מופיע
**פתרון:**
- ודא שלחצת על **"Run"** ולא רק שמרת
- נסה לרענן את הדף (F5) ולהריץ שוב

### בעיה: "This app isn't verified" - לא יכול ללחוץ
**פתרון:**
- לחץ על **"Advanced"** (מתקדם) בתחתית
- לחץ על הקישור הכחול **"Go to [שם] (unsafe)"**
- רק אז תוכל ללחוץ **"Allow"**

### בעיה: "שגיאה: לא נמצאו שאלות"
**פתרון:**
- ודא שהפורמט נכון:
  - שאלות מתחילות ב-`Q1.`, `Q2.`, וכו'
  - תשובות מתחילות ב-`A1.`, `A2.`, וכו'
- ודא שיש נקודה (`.`) אחרי האות והמספר

### בעיה: Sheet/Form לא נוצר
**פתרון:**
- בדוק את היומן (Logs) בתחתית הדף
- חפש שגיאות (בעברית או באנגלית)
- ודא שאישרת את כל ההרשאות

---

## 📝 טיפים
- **שמירת קישורים:** הקישורים נשמרים ביומן (Logs) - ניתן להעתיק משם
- **עריכה:** ניתן לערוך את השאלון בקוד ולהריץ שוב
- **שם הטופס:** ניתן לשנות בשורה: `FormApp.create('השם שלך')`
- **שם ה-Sheet:** ניתן לשנות בשורה: `SpreadsheetApp.create('השם שלך')`

---

## 📊 הגדרת תשובות נכונות וחישוב ציונים אוטומטי

### שלב 1: הגדרת תשובות נכונות בקוד
1. בקוד Apps Script, מצא את הפונקציה `getCorrectAnswers()` (בערך שורה 261)
2. עדכן את התשובות הנכונות לפי הפורמט:
   ```javascript
   '06': 'A1',  // שאלה 6 - התשובה הנכונה היא A1
   ```
3. **פורמט:** `'מספר_שאלה': 'תשובה'`
   - מספר שאלה: 01, 02, 03... (עם אפס מוביל)
   - תשובה: A1, A2, A3, או A4
   - דוגמה: `'06': 'A1'` = שאלה 6, תשובה 1 נכונה

### שלב 2: שמירה והרצה מחדש
1. לחץ **"Save"** (Ctrl+S)
2. הרץ שוב את `createFormFromText`
3. התשובות הנכונות יתעדכנו אוטומטית ב-Sheet בעמודה 9 ("תשובה נכונה")

### שלב 3: עריכה ישירה ב-Sheet (אופציה נוספת)
1. פתח את ה-Google Sheet שנוצר
2. עקור לטאב **"שאלון"**
3. בעמודה **9** ("תשובה נכונה"), עדכן ישירות את התשובות הנכונות
   - דוגמה: בשורה של שאלה 6, כתוב **A1** בעמודה 9
4. **חשוב:** שמור את השינויים (Ctrl+S)

---

## ✅ איך עובד חישוב הציונים?

### אוטומטי לאחר כל הגשת פורם:
1. **תלמיד מגיש את הפורם** → הפונקציה `onFormSubmit()` מופעלת אוטומטית
2. **התשובות משוות** → כל תשובה משווה לתשובה הנכונה
3. **חישוב ציון:**
   - נוצרות עמודות **"ציון"** ו**"אחוז"** בטאב התשובות
   - הציון מופיע בפורמט: `7/10` (7 תשובות נכונות מתוך 10)
   - האחוז מופיע: `70%`
4. **הדגשה אוטומטית:**
   - 🟢 **ירוק** - ציון 80% ומעלה
   - 🟡 **צהוב** - ציון 60-79%
   - 🔴 **אדום** - ציון מתחת ל-60%

### איפה לראות את הציונים?
1. פתח את ה-Google Sheet שנוצר
2. עקור לטאב **"טופס 1"** או **"Form Responses 1"**
3. בצד ימין תראה עמודות **"ציון"** ו**"אחוז"**
4. כל שורה = תשובה של תלמיד עם הציון שלו

---

## ⚙️ טריגר אוטומטי

**מה זה טריגר?**
- טריגר הוא "מערכת התרעה" שמפעילה את הפונקציה `onFormSubmit()` אוטומטית
- נוצר אוטומטית כשמחברים את הפורם ל-Sheet

**איך לוודא שהטריגר פעיל?**
1. ב-Apps Script, לחץ על **⚙️ (גלגל שיניים)** בצד שמאל
2. לחץ על **"Triggers"** (טריגרים)
3. תראה: `onFormSubmit` → `From form` → `On form submit`
4. ✅ אם מופיע - הטריגר פעיל!

**אם הטריגר לא קיים:**
1. ב-Apps Script, לחץ על **⚙️ (גלגל שיניים)** → **"Triggers"**
2. לחץ על **"+ Add Trigger"** (הוסף טריגר)
3. **Choose which function to run:** `onFormSubmit`
4. **Select event source:** `From form`
5. **Select event type:** `On form submit`
6. **Failure notification settings:** בחר תדירות (למשל: "Immediately")
7. לחץ **"Save"** (שמור)
8. ✅ הטריגר מוגדר!

---

## 🎉 סיכום
**3 שלבים פשוטים:**
1. פתח Apps Script → https://script.google.com/
2. העתק קוד מ-`apscript_complete.js`
3. הרץ את `createFormFromText`

**תוצאה:**
- ✅ **Google Sheet** עם כל השאלות והתשובות
- ✅ **Google Form** מוכן לשימוש
- ✅ **חישוב ציונים אוטומטי** לאחר כל הגשת פורם
- ✅ **הדגשה לפי ציון** (ירוק/צהוב/אדום)

---

**בהצלחה! 🚀**

