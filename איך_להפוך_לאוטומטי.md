# ⚙️ איך להפוך חישוב ציונים לאוטומטי

## 🎯 המטרה:
שכל פעם שמישהו מגיש את הפורם, הציונים יחושבו אוטומטית (בלי להריץ `calculateScoreWithSheetId()` ידנית).

---

## ✅ אם אין לך ID - זה בסדר!

**לא צריך ID!** הטריגר ימצא את ה-Sheet אוטומטית דרך הקישור של הפורם.

מה שצריך:
1. ✅ שהפורם יהיה מחובר ל-Sheet
2. ✅ טריגר של `onFormSubmit` → `From form` → `On form submit`

זה הכל! הפונקציה `onFormSubmit(e)` תמצא את הכל אוטומטית.

---

## ✅ פתרון 1: הוסף טריגר ידנית (מומלץ)

### שלב 1: ודא שהפורם מחובר ל-Sheet
1. פתח את הפורם
2. לחץ על **"Responses"** (תגובות) בראש הדף
3. **מה תראה:**
   - ✅ אם יש כפתור **"Unlink"** → הפורם מחובר! ✅
   - ❌ אם יש כפתור **"Link to Sheets"** → הפורם לא מחובר!

**אם הפורם לא מחובר:**
1. לחץ על **"Link to Sheets"**
2. בחר **"Select existing spreadsheet"** (בחר גיליון קיים)
3. חפש את ה-Sheet: `1c_nq9ZhBe5mgYxzTGboQqKdrSBZcvlZjhIHbBk0nDFs`
4. בחר את ה-Sheet
5. לחץ **"Link"** (קשר)

### שלב 2: הוסף טריגר ידנית
1. ב-Apps Script, לחץ על **⚙️ (גלגל שיניים)** בצד שמאל
2. לחץ על **"Triggers"** (טריגרים)
3. לחץ על **"+ Add Trigger"** (הוסף טריגר)

### שלב 3: מלא את השדות
1. **Choose which function to run:** בחר `onFormSubmit`
2. **Select deployment:** בחר `Head` (או הראשון ברשימה)
3. **Select event source:** בחר `From form` ← **זה החשוב!**
4. **Select event type:** בחר `On form submit`
5. **Failure notification settings:** בחר `Immediately`
6. לחץ **"Save"** (שמור)

### שלב 4: בדוק שהטריגר קיים
1. חזור לעמוד **"Triggers"**
2. תראה בטבלה:
   ```
   Function        Event source     Event type       Status
   onFormSubmit    From form       On form submit   Enabled ✅
   ```
3. אם תראה את זה - ✅ **הטריגר מוגדר!**

### שלב 5: נסה את הפורם
1. פתח את הפורם
2. הפרס אותו (Submit) - כמו תלמיד
3. בדוק את Execution log ב-Apps Script:
   - תראה: `🔄 פונקציה onFormSubmit הופעלה`
   - תראה: `✅ ציון מחושב: 7/10 (70%)`
4. פתח את ה-Sheet → טאב "טופס 1" → תראה את הציון!

---

## ✅ פתרון 2: אם "From form" לא מופיע

אם אחרי כל השלבים "From form" עדיין לא מופיע, אפשר להשתמש בטריגר של זמן:

### אופציה A: טריגר כל כמה דקות
1. ב-Apps Script → ⚙️ → **Triggers**
2. **+ Add Trigger**
3. **Choose which function to run:** `calculateScoreWithSheetId`
4. **Select event source:** `Time-driven`
5. **Select type of time based trigger:** `Minutes timer`
6. **Select minute interval:** `Every 5 minutes` (או 10, 15 וכו')
7. לחץ **"Save"**

**זה יחשוב ציונים כל 5 דקות** (אוטומטי, אבל לא מיידי)

### אופציה B: טריגר כל שעה
1. אותו דבר כמו אופציה A, אבל:
2. **Select type of time based trigger:** `Hour timer`
3. **Select hour interval:** `Every hour`

**זה יחשוב ציונים כל שעה**

---

## ⚠️ חשוב לדעת:

### הבדל בין הטריגרים:
- **From form → On form submit:**
  - ✅ חישוב מיידי (כשמישהו מגיש)
  - ✅ הכי מדויק
  - ⚠️ צריך שהפורם יהיה מחובר ל-Sheet

- **Time-driven:**
  - ✅ עובד תמיד (לא צריך חיבור)
  - ⚠️ לא מיידי (רק כל X דקות/שעות)
  - ⚠️ פחות מדויק

---

## 💡 המלצה:

**אם "From form" מופיע** → השתמש בזה! (פתרון 1)

**אם "From form" לא מופיע** → השתמש בטריגר זמן (פתרון 2)

---

## ✅ סיכום מהיר:

1. ✅ ודא שהפורם מחובר ל-Sheet (Responses → Link to Sheets)
2. ✅ הוסף טריגר: ⚙️ → Triggers → + Add Trigger
3. ✅ בחר: `onFormSubmit` → `From form` → `On form submit`
4. ✅ שמור
5. ✅ נסה את הפורם - הציונים יחושבו אוטומטית!

---

**🎉 בהצלחה!**

