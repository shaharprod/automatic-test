# 📘 הוראות שימוש מפורטות - צעד אחר צעד

## 🎯 מטרה
המרת שאלון טקסט ל-Google Sheets ואז ל-Google Form אוטומטית.

---

## 📋 חלק א': הכנה והתקנה

### שלב 1: התקנת Python (אם אין)
1. לך לאתר: https://www.python.org/downloads/
2. הורד את הגרסה האחרונה של Python 3
3. התקן (סמן ✅ "Add Python to PATH" בהתקנה)
4. פתח PowerShell והקלד: `python --version`
5. אם מופיעה גרסה - ✅ הצלחת!

### שלב 2: התקנת ספריות Python
1. פתח PowerShell בתיקיית הפרויקט:
   ```
   cd "C:\Users\User\Downloads\automate american test"
   ```
2. התקן את הספריות:
   ```bash
   pip install -r requirements.txt
   ```
3. המתן לסיום ההתקנה - ✅ הצלחת!

### שלב 3: הגדרת Google Cloud Project
1. לך לאתר: https://console.cloud.google.com/
2. התחבר עם חשבון Google שלך
3. לחץ על **"Select a project"** > **"New Project"**
4. הכנס שם לפרויקט (למשל: "Questionnaire Automation")
5. לחץ על **"Create"**
6. המתן כמה שניות לפרויקט להיווצר

### שלב 4: הפעלת Google APIs
1. בתוך הפרויקט שלך, לחץ על תפריט ☰ (3 שורות)
2. לך ל-**"APIs & Services"** > **"Library"**
3. חפש **"Google Sheets API"**:
   - לחץ על התוצאה
   - לחץ על **"Enable"** (הפעל)
   - ✅ Sheets API מופעל!
4. חפש **"Google Forms API"**:
   - לחץ על התוצאה
   - לחץ על **"Enable"** (הפעל)
   - ✅ Forms API מופעל!

### שלב 5: יצירת OAuth Credentials
1. לך ל-**"APIs & Services"** > **"Credentials"**
2. לחץ על **"+ CREATE CREDENTIALS"** (למעלה)
3. בחר **"OAuth client ID"**
4. אם תתבקש - הסכם לתנאי השימוש
5. **Configure consent screen:**
   - בחר **"External"** (חיצוני) > **"Create"**
   - הכנס שם אפליקציה (למשל: "Questionnaire Tool")
   - הכנס אימייל
   - לחץ **"Save and Continue"** (שמור והמשך) 3 פעמים
   - לחץ **"Back to Dashboard"** (חזור)
6. חזור ל-**"Credentials"** > **"+ CREATE CREDENTIALS"** > **"OAuth client ID"**
7. **Application type:** בחר **"Desktop app"** (אפליקציית שולחן עבודה)
8. **Name:** הכנס שם (למשל: "Questionnaire Client")
9. לחץ **"Create"** (צור)
10. לחץ על **"Download JSON"** (הורד JSON)
11. שמור את הקובץ בתיקיית הפרויקט בשם: **`credentials.json`**
   - מיקום: `C:\Users\User\Downloads\automate american test\credentials.json`
   - ✅ הקובץ מוכן!

---

## 🚀 חלק ב': הרצת הסקריפט Python

### שלב 1: בדיקת קובץ השאלון
1. ודא שקובץ **`apscript.txt`** קיים בתיקיית הפרויקט
2. פתח את הקובץ ובדוק שהפורמט נכון:
   ```
   Q1. שאלה?
   A1. תשובה 1
   A2. תשובה 2
   ...
   ```

### שלב 2: הרצת הסקריפט
1. פתח PowerShell בתיקיית הפרויקט:
   ```bash
   cd "C:\Users\User\Downloads\automate american test"
   ```
2. הרץ את הסקריפט:
   ```bash
   python upload_to_sheets.py
   ```

### שלב 3: אימות Google (בפעם הראשונה)
1. יפתח חלון דפדפן אוטומטית
2. בחר את חשבון Google שלך
3. ייתכן שתקבל אזהרה "Google hasn't verified this app":
   - לחץ על **"Advanced"** (מתקדם)
   - לחץ על **"Go to [שם הפרויקט] (unsafe)"**
4. לחץ על **"Allow"** (אפשר) כדי לאשר את ההרשאות
5. **הרשאות נדרשות:**
   - ✅ Google Sheets - קריאה וכתיבה
   - ✅ Google Forms - יצירה

### שלב 4: תוצאות הסקריפט
1. הסקריפט יציג:
   ```
   🚀 מתחיל תהליך העלאת שאלון ל-Google Sheets...
   📄 קורא שאלון מקובץ: apscript.txt
   📋 נמצאו 10 שאלות
   ✅ נוצר Google Sheet: [ID]
   🔗 קישור: https://docs.google.com/spreadsheets/d/[ID]
   ✅ עודכנו X תאים
   ✅ הושלם! Spreadsheet ID נשמר ב-spreadsheet_id.txt
   ```
2. **שמור את הקישור ל-Google Sheet!** תזדקק לו בשלב הבא
3. הקישור גם נשמר בקובץ **`spreadsheet_id.txt`**

---

## 📝 חלק ג': יצירת Google Form

### שלב 1: פתיחת Google Sheet
1. פתח את הקישור ל-Google Sheet שנוצר (מהשלב הקודם)
2. ודא שאתה רואה את כל השאלות והתשובות בעמודות

### שלב 2: פתיחת Apps Script
1. בשורה העליונה של Google Sheets, לחץ על **"Extensions"** (תוספות)
2. בחר **"Apps Script"**
3. יפתח חלון חדש של Apps Script

### שלב 3: העתקת הקוד
1. בחלון Apps Script, מחק את כל הקוד הקיים (אם יש)
2. פתח את קובץ **`apscript.js`** מתיקיית הפרויקט
3. העתק את **כל התוכן** (Ctrl+A, Ctrl+C)
4. הדבק בחלון Apps Script (Ctrl+V)

### שלב 4: שמירת הפרויקט
1. לחץ על **"Save"** (שמור) או Ctrl+S
2. אם תתבקש לתת שם לפרויקט:
   - הכנס שם (למשל: "Create Form from Sheet")
   - לחץ **"OK"**

### שלב 5: הרצת הפונקציה
1. בחלון Apps Script, בראש הדף, תראה רשימה נפתחת עם שם פונקציה
2. לחץ על הרשימה הנפתחת ובחר **`createFormFromSheet`**
3. לחץ על כפתור **"Run"** (▶) בצד

### שלב 6: אישור הרשאות (בפעם הראשונה)
1. יופיע חלון **"Authorization required"**
2. לחץ על **"Review permissions"** (סקור הרשאות)
3. בחר את חשבון Google שלך
4. ייתכן שתקבל אזהרה "Google hasn't verified this app":
   - לחץ על **"Advanced"**
   - לחץ על **"Go to [שם הפרויקט] (unsafe)"**
5. לחץ **"Allow"** (אפשר) לאשר את כל ההרשאות הנדרשות

### שלב 7: בדיקת התוצאה
1. לאחר אישור ההרשאות, הפונקציה תרוץ
2. בחלון Apps Script, בתחתית, תראה **"Execution log"** (יומן ביצוע)
3. אם הכל עבד, תראה:
   ```
   ✅ Google Form נוצר בהצלחה!
   🔗 קישור הטופס: https://docs.google.com/forms/d/[ID]
   📝 Form ID: [ID]
   ```
4. יופיע חלון הודעה:
   - ✅ Google Form נוצר בהצלחה!
   - 🔗 קישור הטופס נשמר בתא J2
   - 📝 Form ID נשמר בתא K2
5. לחץ **"OK"**

### שלב 8: פתיחת Google Form
1. חזור ל-Google Sheet
2. עקור לעמודה **J** (עמודה 10) - שם נמצא קישור הטופס
3. לחץ על הקישור (או העתק אותו)
4. **🎉 הטופס מוכן עם כל השאלות והתשובות!**

---

## ✅ סיכום - מה נוצר?
- ✅ **Google Sheet** עם כל השאלות והתשובות מובנות
- ✅ **Google Form** עם כל 10 השאלות ו-4 אפשרויות תשובה לכל שאלה
- ✅ הקישורים נשמרים ב-Google Sheet (עמודות J ו-K)

---

## ⚠️ פתרון בעיות נפוצות

### בעיה: "לא נמצא קובץ credentials.json"
**פתרון:**
- ודא שהורדת את קובץ ה-JSON מ-Google Cloud Console
- ודא ששמרת אותו בשם **`credentials.json`** (בדיוק!)
- ודא שהוא בתיקיית הפרויקט

### בעיה: "APIs לא מופעלות"
**פתרון:**
- חזור ל-Google Cloud Console
- ודא ש-Google Sheets API מופעל
- ודא ש-Google Forms API מופעל
- המתן 1-2 דקות לאחר ההפעלה

### בעיה: "שגיאה בהרשאות ב-Apps Script"
**פתרון:**
- ודא שאישרת את כל ההרשאות
- נסה להריץ שוב את הפונקציה
- בדוק שיש לך גישה ל-Google Sheets ו-Google Forms

### בעיה: "שאלות לא מופיעות בטופס"
**פתרון:**
- ודא שהשיטס מכיל נתונים בפורמט הנכון
- בדוק שהעמודה הראשונה (A) מכילה מספרי שאלות (1, 2, 3...)
- בדוק שהעמודה השנייה (B) מכילה את השאלות
- בדוק שהעמודה השלישית (C) מכילה את סוג השאלה (multiple_choice או text)

### בעיה: "שגיאת Python"
**פתרון:**
- ודא ש-Python מותקן: `python --version`
- ודא שהתקנת את הספריות: `pip install -r requirements.txt`
- אם יש שגיאה, העתק את הודעת השגיאה וחפש אותה בגוגל

---

## 📞 עזרה נוספת
אם נתקלת בבעיות:
1. בדוק את קובץ `README.md` למידע נוסף
2. ודא שכל השלבים בוצעו בסדר
3. בדוק שה-APIs מופעלות ב-Google Cloud Console

---

**🎉 בהצלחה!**

