<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
  <meta charset="UTF-8">
  <title>×™×¦×™×¨×ª ×©××œ×•×Ÿ ×¢× ×¦×™×•× ×™× ××•×˜×•××˜×™×™×</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    body {
      padding: 20px;
      background: #f5f5f5;
      direction: rtl;
    }
    .container {
      max-width: 100%;
      background: white;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #1a73e8;
      margin-bottom: 10px;
      font-size: 24px;
    }
    h2 {
      color: #5f6368;
      font-size: 16px;
      margin-top: 25px;
      margin-bottom: 10px;
    }
    .instructions {
      background: #e8f0fe;
      padding: 15px;
      border-radius: 5px;
      margin-bottom: 20px;
      border-right: 4px solid #1a73e8;
    }
    .instructions ol {
      margin: 10px 0;
      padding-right: 20px;
    }
    .instructions li {
      margin-bottom: 8px;
    }
    textarea {
      width: 100%;
      min-height: 200px;
      padding: 12px;
      border: 2px solid #dadce0;
      border-radius: 5px;
      font-size: 14px;
      font-family: 'Courier New', monospace;
      direction: rtl;
      resize: vertical;
    }
    textarea:focus {
      outline: none;
      border-color: #1a73e8;
    }
    .example {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 5px;
      margin-top: 10px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      white-space: pre-wrap;
      direction: rtl;
    }
    .answers-input {
      width: 100%;
      min-height: 80px;
      padding: 12px;
      border: 2px solid #dadce0;
      border-radius: 5px;
      font-size: 14px;
      font-family: 'Courier New', monospace;
      direction: rtl;
      resize: vertical;
      margin-bottom: 10px;
    }
    .answers-input:focus {
      outline: none;
      border-color: #1a73e8;
    }
    .answers-help {
      font-size: 12px;
      color: #5f6368;
      margin-top: 5px;
    }
    button {
      background: #1a73e8;
      color: white;
      border: none;
      padding: 15px 30px;
      font-size: 16px;
      border-radius: 5px;
      cursor: pointer;
      width: 100%;
      margin-top: 20px;
      font-weight: bold;
    }
    button:hover {
      background: #1557b0;
    }
    button:disabled {
      background: #dadce0;
      cursor: not-allowed;
    }
    .loading {
      display: none;
      text-align: center;
      margin-top: 15px;
      color: #1a73e8;
    }
    .result {
      display: none;
      margin-top: 20px;
      padding: 15px;
      border-radius: 5px;
    }
    .result.success {
      background: #e8f5e9;
      border-right: 4px solid #4caf50;
    }
    .result.error {
      background: #ffebee;
      border-right: 4px solid #f44336;
    }
    .result a {
      color: #1a73e8;
      text-decoration: none;
      font-weight: bold;
      display: block;
      margin-top: 10px;
    }
    .result a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ“ ×™×¦×™×¨×ª ×©××œ×•×Ÿ ×¢× ×¦×™×•× ×™× ××•×˜×•××˜×™×™×</h1>

    <div class="instructions">
      <strong>×”×•×¨××•×ª ×§×¦×¨×•×ª:</strong>
      <ol>
        <li>×”×›× ×¡ ××ª ×”×©××œ×•×Ÿ ×©×œ×š ×œ××˜×” (×¢× ×”×ª×©×•×‘×•×ª)</li>
        <li>×”×›× ×¡ ××ª ×”×ª×©×•×‘×•×ª ×”× ×›×•× ×•×ª (×œ××©×œ: ×©××œ×” 1 = ×, ×©××œ×” 2 = ×‘)</li>
        <li>×œ×—×¥ "×¦×•×¨ ×¤×•×¨×" ×•×”×›×œ ×™×¢×‘×•×“ ××•×˜×•××˜×™×ª!</li>
      </ol>
    </div>

    <h2>0ï¸âƒ£ ×©× ×”×©××œ×•×Ÿ:</h2>
    <input type="text" id="questionnaireName" class="answers-input" placeholder="×œ××©×œ: ×©××œ×•×Ÿ - 31.10.2025" style="min-height: 40px; margin-bottom: 20px;">

    <h2>1ï¸âƒ£ ×”×›× ×¡ ××ª ×”×©××œ×•×Ÿ ×©×œ×š:</h2>
    <textarea id="questionnaire">×©××œ×” 1. ××”×• ×”×¢×™×§×¨×•×Ÿ ×”××¨×›×–×™ ×©×œ "×œ××™×“×” ××•× ×—×™×ª"?
×. ××ª×Ÿ ×ª×©×•×‘×” ××œ××” ×•××§×™×¤×”
×‘. ×©×™××•×© ×‘××•×“×œ×™× ××ª×§×“××™×
×’. ×‘× ×™×™×ª ×“×™××œ×•×’ ××™× ×˜×¨××§×˜×™×‘×™ ×©××¤×¨×§ ×‘×¢×™×•×ª ×•××§×“× ××ª ×”×œ×•××“ ×¦×¢×“ ××—×¨ ×¦×¢×“
×“. ×™×¦×™×¨×ª ××—×•×•× ×™× ××•×ª×××™× ××™×©×™×ª ××•×˜×•××˜×™×ª

×©××œ×” 2. ××”×• ×”×™×ª×¨×•×Ÿ ×”×¢×™×§×¨×™ ×©×œ ×©×™××•×© ×‘-AI ×‘×—×™× ×•×š?
×. ×—×™×¡×›×•×Ÿ ×‘×–××Ÿ ×œ××•×¨×”
×‘. ××ª×Ÿ ××©×•×‘ ××•×ª×× ××™×©×™×ª ×•××™×™×“×™ ×œ×ª×œ××™×“×™×
×’. ×”×—×œ×¤×ª ×”××•×¨×” ×œ×—×œ×•×˜×™×Ÿ
×“. ×”×¤×—×ª×ª ×¢×œ×•×™×•×ª ××¢×¨×›×ª ×”×—×™× ×•×š

×©××œ×” 3. ×›×™×¦×“ × ×™×ª×Ÿ ×œ×©×¤×¨ ××ª ××™×›×•×ª ×”××©×•×‘ ×œ×ª×œ××™×“×™×?
×. ×‘×××¦×¢×•×ª ××ª×Ÿ ×¦×™×•× ×™× ×‘×œ×‘×“
×‘. ×¢×œ ×™×“×™ ××ª×Ÿ ×”×¡×‘×¨×™× ××¤×•×¨×˜×™× ×•××›×•×•× ×™× ×œ×¤×¢×•×œ×”
×’. ×¨×§ ×‘×××¦×¢×•×ª ×”×¢×¨×•×ª ×§×¦×¨×•×ª
×“. ×œ×œ× ×¦×•×¨×š ×‘××©×•×‘ ×›×œ×œ</textarea>

    <div class="example">
ğŸ’¡ <strong>×“×•×’××” ×–×• ××•×¤×™×¢×” ×›×‘×¨×™×¨×ª ××—×“×œ</strong> - ×ª×•×›×œ ×œ××—×•×§ ×•×œ×”×›× ×™×¡ ×©××œ×•×Ÿ ××©×œ×š
    </div>

    <h2>2ï¸âƒ£ ×”×›× ×¡ ××ª ×”×ª×©×•×‘×•×ª ×”× ×›×•× ×•×ª:</h2>
    <textarea id="correctAnswers" class="answers-input" placeholder="×”×–×Ÿ ×‘×¤×•×¨××˜: 01:×, 02:×‘, 03:×’">01:×’, 02:×‘, 03:×‘</textarea>
    <div class="answers-help">
      ğŸ’¡ <strong>×“×•×’××”:</strong> ×× ×”×©××œ×” 1 ×”×ª×©×•×‘×” ×”× ×›×•× ×” ×”×™× "×’", ×”×©××œ×” 2 ×”×ª×©×•×‘×” ×”× ×›×•× ×” ×”×™× "×‘", ×•×›×•'
      <br>
      ğŸ’¡ <strong>×¤×•×¨××˜:</strong> <strong>01:×’, 02:×‘, 03:×‘</strong> (××¡×¤×¨ ×©××œ×”:×ª×©×•×‘×” × ×›×•× ×”)
      <br>
      ğŸ’¡ ×ª×•×›×œ ×œ××—×•×§ ×•×œ×”×›× ×™×¡ ×ª×©×•×‘×•×ª ××©×œ×š
    </div>

    <button onclick="createForm()">ğŸš€ ×¦×•×¨ ×¤×•×¨× ×¢×›×©×™×•!</button>

    <div id="loading" class="loading">
      â³ ×™×•×¦×¨ ××ª ×”×¤×•×¨×... ×× × ×”××ª×Ÿ...
    </div>

    <div id="result" class="result"></div>
  </div>

  <script>
    function createForm() {
      const questionnaire = document.getElementById('questionnaire').value.trim();
      const answersText = document.getElementById('correctAnswers').value.trim();

      if (!questionnaire) {
        showResult(false, '×× × ×”×›× ×¡ ×©××œ×•×Ÿ');
        return;
      }

      // ×¤×¨×¡×•×¨ ×ª×©×•×‘×•×ª × ×›×•× ×•×ª
      let correctAnswers = {};

      // × ×¡×” ×¤×•×¨××˜: 01:×, 02:×‘, 03:×’, ××• 01:×“, 02:×’, ×•×›×•'
      if (answersText) {
        const pairs = answersText.split(',').map(s => s.trim());
        pairs.forEach(function(pair) {
          // ××—×¤×© ×¤×•×¨××˜: ××¡×¤×¨:××•×ª ××• ××¡×¤×¨=××•×ª (×ª×•××š ×’× ×‘-×”)
          const match = pair.match(/(\d+)[:=]\s*([××‘×’×“×”])/);
          if (match) {
            const qNum = match[1].padStart(2, '0');
            const answer = match[2];
            correctAnswers[qNum] = answer;
          }
        });
      }

      // ×× ××™×Ÿ ×ª×©×•×‘×•×ª, ×”×©×ª××© ×‘×‘×¨×™×¨×•×ª ××—×“×œ
      if (Object.keys(correctAnswers).length === 0) {
        // × ×¡×” ×œ×–×”×•×ª ××”×©××œ×•×Ÿ ×›××” ×©××œ×•×ª ×™×©
        const questionMatches = questionnaire.match(/×©××œ×”\s+(\d+)/g);
        if (questionMatches) {
          questionMatches.forEach(function(match) {
            const num = match.replace(/×©××œ×”\s+/, '').padStart(2, '0');
            correctAnswers[num] = '×'; // ×‘×¨×™×¨×ª ××—×“×œ
          });
        }
      }

      document.getElementById('loading').style.display = 'block';
      document.getElementById('result').style.display = 'none';
      document.querySelector('button').disabled = true;

      const questionnaireName = document.getElementById('questionnaireName').value.trim() || '×©××œ×•×Ÿ - ' + new Date().toLocaleDateString('he-IL');

      google.script.run
        .withSuccessHandler(function(result) {
          document.getElementById('loading').style.display = 'none';
          document.querySelector('button').disabled = false;

          if (result.success) {
            showResult(true, '×”×¤×•×¨× × ×•×¦×¨ ×‘×”×¦×œ×—×”!', result.sheetUrl, result.formUrl);
          } else {
            showResult(false, result.message || '××™×¨×¢×” ×©×’×™××”');
          }
        })
        .withFailureHandler(function(error) {
          document.getElementById('loading').style.display = 'none';
          document.querySelector('button').disabled = false;
          showResult(false, '×©×’×™××”: ' + error.message);
        })
        .createFormFromGUI(questionnaire, JSON.stringify(correctAnswers), questionnaireName);
    }

    function showResult(success, message, sheetUrl, formUrl) {
      const resultDiv = document.getElementById('result');
      resultDiv.className = 'result ' + (success ? 'success' : 'error');
      resultDiv.style.display = 'block';

      let html = '<strong>' + message + '</strong>';

      if (success && sheetUrl && formUrl) {
        html += '<br><br>';
        html += 'ğŸ“Š <a href="' + sheetUrl + '" target="_blank">×¤×ª×— ××ª ×”-Google Sheet</a>';
        html += '<br>';
        html += 'ğŸ“ <a href="' + formUrl + '" target="_blank">×¤×ª×— ××ª ×”-Google Form</a>';
        html += '<br><br>';
        html += 'ğŸ’¡ ×—×©×•×‘: ×”×•×¡×£ ×˜×¨×™×’×¨ ×™×“× ×™×ª ×›×“×™ ×©×”×¦×™×•× ×™× ×™×—×•×©×‘×• ××•×˜×•××˜×™×ª';
        html += '<br>';
        html += 'âš™ï¸ â†’ Triggers â†’ + Add Trigger â†’ onFormSubmit â†’ From form â†’ On form submit';
      }

      resultDiv.innerHTML = html;
    }
  </script>
</body>
</html>

