# 📘 הוראות מלאות למורה - יצירת שאלון עם חישוב ציונים אוטומטי

## 🎯 מה זה עושה?
הכלי הזה יוצר:
- ✅ **Google Form** (טופס) עם שאלות ו-4 אפשרויות תשובה
- ✅ **Google Sheet** (גיליון) עם כל השאלות והתשובות
- ✅ **חישוב ציונים אוטומטי** - כל פעם שתלמיד מגיש את הפורם, הציון מחושב אוטומטית!
- ✅ **הדגשה לפי ציון** - ירוק (80%+), צהוב (60-79%), אדום (מתחת ל-60%)

---

## 📋 חלק א': יצירת הפורם והשאלון

### שלב 1: פתיחת Google Apps Script (1 דקה)
1. פתח דפדפן (Chrome/Edge/Firefox)
2. לך לכתובת: **https://script.google.com/**
3. התחבר עם חשבון Google שלך (החשבון שבו תיצור את הפורמים)
4. לחץ על **"+ New project"** (פרויקט חדש) למעלה משמאל
5. יפתח חלון חדש של Apps Script

### שלב 2: העתקת הקוד (2 דקות)
1. פתח את קובץ **`apscript_complete.js`** מהמחשב שלך
   - לחץ עליו לחיצה כפולה (או לחץ ימני → פתח ב-Notepad/VSCode)
2. העתק את **כל התוכן**:
   - לחץ **Ctrl+A** (לבחור הכל)
   - לחץ **Ctrl+C** (להעתיק)
3. חזור לחלון Apps Script
4. מחק את הקוד הקיים (אם יש):
   - לחץ **Ctrl+A** (לבחור הכל)
   - לחץ **Delete**
5. הדבק את הקוד:
   - לחץ **Ctrl+V** (להדביק)
6. שמור את הפרויקט:
   - לחץ **Ctrl+S** (או כפתור "Save" למעלה)
   - אם תתבקש לתת שם: כתוב **"יצירת שאלון עם ציונים"**
   - לחץ **OK**

### שלב 3: עריכת השאלון (אם רוצים לשנות) - אופציונלי
1. בקוד Apps Script, מצא את המשתנה `QUESTIONNAIRE_TEXT` (בערך שורה 20)
2. בין הסימנים `` ` `` (3 סימנים מסוג backtick), יש את השאלון הנוכחי
3. אם רוצים לשנות שאלות:
   - ערוך את השאלות לפי הפורמט:
     ```
     Q1. השאלה הראשונה?
     A1. תשובה אפשרית 1
     A2. תשובה אפשרית 2
     A3. תשובה אפשרית 3
     A4. תשובה אפשרית 4

     Q2. השאלה השנייה?
     A1. תשובה אפשרית 1
     A2. תשובה אפשרית 2
     A3. תשובה אפשרית 3
     A4. תשובה אפשרית 4
     ```
   - **חשוב:** כל שאלה מתחילה ב-`Q1.`, `Q2.`, וכו'
   - **חשוב:** כל תשובה מתחילה ב-`A1.`, `A2.`, `A3.`, `A4.`
   - **חשוב:** יש רווח בין שאלות (שורה ריקה)

### שלב 4: הרצת הקוד ויצירת הפורם (3 דקות)
1. בחלון Apps Script, בראש הדף, תראה רשימה נפתחת (dropdown) עם שם פונקציה
2. לחץ על הרשימה ובחר **`createFormFromText`**
3. לחץ על כפתור **"Run"** (▶) בצד (או לחץ **Ctrl+Enter**)
4. **בפעם הראשונה - אישור הרשאות:**
   - יופיע חלון **"Authorization required"** (נדרש אישור)
   - לחץ על **"Review permissions"** (סקור הרשאות)
   - בחר את חשבון Google שלך
   - ייתכן שתקבל אזהרה **"Google hasn't verified this app"**:
     - זה נורמלי! לחץ על **"Advanced"** (מתקדם) בתחתית
     - לחץ על הקישור הכחול **"Go to [שם הפרויקט] (unsafe)"**
     - רק אז תוכל ללחוץ **"Allow"** (אפשר)
   - לחץ **"Allow"** לאשר את כל ההרשאות הנדרשות:
     - ✅ Google Sheets - קריאה וכתיבה
     - ✅ Google Forms - יצירה ועריכה
5. לאחר אישור ההרשאות, הקוד ירוץ אוטומטית
6. **תוצאה:**
   - בתחתית חלון Apps Script, לחץ על **"Execution log"** (יומן ביצוע)
   - תראה הודעה עם 2 קישורים:
     - **📊 Google Sheet** - הגיליון עם כל השאלות
     - **📝 Google Form** - הטופס המוכן לשימוש!
   - **חשוב:** העתק את הקישורים מהלוג - תזדקק להם!
   - ייתכן שיופיע חלון הודעה (אם הדפדפן מאפשר) - לחץ **OK**

### שלב 5: בדיקת התוצאה (1 דקה)
1. **העתק את הקישורים מהיומן (Execution log):**
   - בתחתית חלון Apps Script, לחץ על **"Execution log"** (יומן ביצוע)
   - חפש את השורות עם "📊 Google Sheet:" ו-"📝 Google Form:"
   - העתק את הקישורים (לחיצה ימנית → Copy)
2. פתח את הקישור ל-**Google Sheet**
3. ודא שאתה רואה:
   - טאב **"שאלון"** עם כל השאלות והתשובות
   - עמודה 9: **"תשובה נכונה"** (עדיין ריק או עם ערכים)
3. לחץ על הקישור ל-**Google Form**
4. ודא שהטופס מכיל את כל השאלות עם 4 אפשרויות תשובה לכל שאלה
5. **✅ הפורם מוכן!**

---

## 📊 חלק ב': הגדרת תשובות נכונות

### שלב 1: הגדרת תשובות נכונות בקוד
1. חזור לחלון Apps Script
2. בקוד, מצא את הפונקציה `getCorrectAnswers()` (בערך שורה 261)
3. תראה קוד שנראה כך:
   ```javascript
   function getCorrectAnswers() {
     return {
       '01': 'A1',  // שאלה 1
       '02': 'A3',  // שאלה 2
       '03': 'A1',  // שאלה 3
       '04': 'A4',  // שאלה 4
       '05': 'A2',  // שאלה 5
       '06': 'A1',  // שאלה 6 - מונח LearnLM
       '07': 'A2',  // שאלה 7
       '08': 'A3',  // שאלה 8
       '09': 'A4',  // שאלה 9
       '10': 'A1'   // שאלה 10
     };
   }
   ```
4. **ערוך את התשובות הנכונות:**
   - לכל שאלה, כתוב את התשובה הנכונה (A1, A2, A3, או A4)
   - **פורמט:** `'מספר_שאלה': 'תשובה'`
   - **דוגמה:** `'06': 'A1'` = שאלה 6, התשובה הנכונה היא A1
   - **חשוב:** מספר השאלה עם אפס מוביל (01, 02, 03... ולא 1, 2, 3)
5. **דוגמה לעריכה:**
   ```javascript
   '01': 'A3',  // שאלה 1 - התשובה הנכונה היא A3
   '02': 'A1',  // שאלה 2 - התשובה הנכונה היא A1
   '06': 'A1',  // שאלה 6 - התשובה הנכונה היא A1 (כפי שביקשת)
   ```
6. שמור את השינויים: **Ctrl+S**

### שלב 2: עדכון התשובות ב-Sheet (אם שינית בקוד)
1. אם שינית תשובות נכונות בקוד, צריך להריץ שוב את `createFormFromText`:
   - לחץ על הרשימה הנפתחת → בחר **`createFormFromText`**
   - לחץ **Run** (▶)
   - **הערה:** זה ייצור Sheet חדש - השתמש בקישור החדש!
2. **או עדכן ישירות ב-Sheet:**
   - פתח את ה-Google Sheet
   - עקור לטאב **"שאלון"**
   - בעמודה **9** ("תשובה נכונה"), עדכן ישירות:
     - בשורה של שאלה 1, כתוב **A1** (או A2, A3, A4 לפי התשובה הנכונה)
     - בשורה של שאלה 2, כתוב **A3** (או התשובה הנכונה)
     - וכך הלאה...
   - **חשוב:** שמור את השינויים (Ctrl+S)

---

## ✅ חלק ג': איך עובד חישוב הציונים?

### תהליך אוטומטי:
1. **תלמיד פותח את הפורם** → עונה על השאלות → לוחץ "שלח"
2. **הטופס נשלח** → הפונקציה `onFormSubmit()` מופעלת אוטומטית
3. **התשובות משוות:**
   - כל תשובה של התלמיד משווה לתשובה הנכונה (מעמודה 9 ב-Sheet)
   - אם תשובה נכונה → ספירה +1
   - אם תשובה שגויה → ללא ספירה
4. **חישוב ציון:**
   - נוצרות עמודות **"ציון"** ו**"אחוז"** בטאב התשובות
   - **ציון:** מופיע בפורמט `7/10` (7 תשובות נכונות מתוך 10)
   - **אחוז:** מופיע `70%`
5. **הדגשה אוטומטית:**
   - 🟢 **ירוק** - ציון 80% ומעלה (מעולה!)
   - 🟡 **צהוב** - ציון 60-79% (טוב)
   - 🔴 **אדום** - ציון מתחת ל-60% (נדרש שיפור)

### איפה לראות את הציונים?
1. פתח את ה-Google Sheet שנוצר
2. עקור לטאב **"טופס 1"** או **"Form Responses 1"**
   - זה הטאב שנוצר אוטומטית כשתלמידים מגישים את הפורם
3. בצד ימין (אחרי כל השאלות) תראה:
   - עמודה **"ציון"** - עם הציון בפורמט `7/10`
   - עמודה **"אחוז"** - עם האחוז `70%`
4. כל שורה = תשובה של תלמיד אחד עם הציון שלו

### בדיקת שהכל עובד:
1. **בדיקת טריגר:**
   - ב-Apps Script, לחץ על **⚙️ (גלגל שיניים)** בצד שמאל
   - לחץ על **"Triggers"** (טריגרים)
   - תראה: `onFormSubmit` → `From form` → `On form submit`
   - ✅ אם מופיע - הטריגר פעיל והכל יעבוד אוטומטית!
2. **בדיקה ידנית:**
   - פתח את הפורם עצמו
   - ענה על השאלות (כמו תלמיד)
   - לחץ **"שלח"**
   - חזור ל-Sheet → עקור לטאב **"טופס 1"**
   - בצד ימין תראה את הציון שלך!

---

## ⚙️ חלק ד': בדיקה ותיקון בעיות

### בעיה: הטריגר לא קיים
**פתרון:**
1. ב-Apps Script, לחץ על **⚙️ (גלגל שיניים)** → **"Triggers"**
2. לחץ על **"+ Add Trigger"** (הוסף טריגר)
3. **Choose which function to run:** בחר `onFormSubmit`
4. **Select event source:** בחר `From form`
5. **Select event type:** בחר `On form submit`
6. **Failure notification settings:** בחר **"Immediately"** (מיידי)
7. לחץ **"Save"** (שמור)
8. ✅ הטריגר מוגדר!

### בעיה: הציונים לא מחושבים
**פתרון:**
1. ודא שהפורם מחובר ל-Sheet:
   - פתח את הפורם
   - לחץ על **⚙️ (הגדרות)** → **"Responses"** (תגובות)
   - ודא ש-**"Accepting responses"** מסומן ✅
   - ודא ש-**"Select response destination"** → **"New spreadsheet"** או **"Existing spreadsheet"**
2. ודא שיש תשובות נכונות ב-Sheet:
   - פתח את ה-Sheet
   - עקור לטאב **"שאלון"**
   - ודא שבעמודה 9 ("תשובה נכונה") יש ערכים (A1, A2, A3, או A4)
3. נסה להריץ את הפורם שוב (תשובה ידנית) ולראות אם הציון מחושב

### בעיה: "Authorization required" לא מופיע
**פתרון:**
1. ודא שלחצת על **"Run"** ולא רק שמרת
2. נסה לרענן את הדף (F5) ולהריץ שוב
3. ודא שאישרת את כל ההרשאות בפעם הראשונה

### בעיה: "This app isn't verified" - לא יכול ללחוץ Allow
**פתרון:**
1. זה נורמלי! לחץ על **"Advanced"** (מתקדם) בתחתית
2. לחץ על הקישור הכחול **"Go to [שם הפרויקט] (unsafe)"**
3. רק אז תוכל ללחוץ **"Allow"** (אפשר)

### בעיה: Sheet/Form לא נוצר
**פתרון:**
1. בדוק את היומן (Logs) בתחתית חלון Apps Script
   - לחץ על **"Execution log"** (יומן ביצוע)
   - חפש שגיאות (בעברית או באנגלית)
2. ודא שהפורמט של השאלון נכון:
   - שאלות מתחילות ב-`Q1.`, `Q2.`, וכו'
   - תשובות מתחילות ב-`A1.`, `A2.`, וכו'
   - יש נקודה (`.`) אחרי האות והמספר
3. ודא שאישרת את כל ההרשאות

---

## 📝 חלק ה': טיפים שימושיים

### עריכת שם הפורם:
1. בקוד Apps Script, מצא את השורה:
   ```javascript
   const form = FormApp.create('שאלון בינה מלאכותית בחינוך');
   ```
2. שנה את השם בתוך הסוגריים:
   ```javascript
   const form = FormApp.create('השאלון שלי');
   ```
3. שמור והרץ שוב את `createFormFromText`

### עריכת שם ה-Sheet:
1. בקוד Apps Script, מצא את השורה:
   ```javascript
   const ss = SpreadsheetApp.create('שאלון לטפסים - ' + new Date().toLocaleDateString('he-IL'));
   ```
2. שנה את השם:
   ```javascript
   const ss = SpreadsheetApp.create('הגיליון שלי');
   ```
3. שמור והרץ שוב

### שמירת קישורים:
- הקישורים נשמרים ב-Google Sheet:
   - עמודה **J** (10): קישור הפורם
   - עמודה **K** (11): Form ID
- **הדרך הקלה ביותר לראות את הקישורים:**
  - בתחתית חלון Apps Script, לחץ על **"Execution log"** (יומן ביצוע)
  - שם תראה את כל הקישורים עם הסימונים 📊 ו-📝

### יצירת שאלון חדש:
- אם רוצים ליצור שאלון חדש (עם שאלות אחרות):
  1. ערוך את `QUESTIONNAIRE_TEXT` בקוד
  2. עדכן את `getCorrectAnswers()` עם התשובות הנכונות
  3. שמור והרץ שוב את `createFormFromText`
  4. **הערה:** זה ייצור Sheet ופורם חדשים!

---

## 🎉 סיכום - צעדים מהירים

### ליצירת שאלון חדש:
1. ✅ פתח **https://script.google.com/**
2. ✅ העתק קוד מ-**`apscript_complete.js`**
3. ✅ ערוך את `QUESTIONNAIRE_TEXT` (אם רוצים)
4. ✅ ערוך את `getCorrectAnswers()` עם התשובות הנכונות
5. ✅ הרץ את **`createFormFromText`**
6. ✅ אשר הרשאות (בפעם הראשונה)
7. ✅ **הפורם מוכן!**

### לאחר יצירת הפורם:
- ✅ **הפורם:** מוכן לשיתוף עם תלמידים
- ✅ **ה-Sheet:** מכיל את כל השאלות והתשובות הנכונות
- ✅ **חישוב ציונים:** אוטומטי - כל פעם שתלמיד מגיש, הציון מחושב!
- ✅ **הדגשה:** אוטומטית לפי ציון (ירוק/צהוב/אדום)

---

## 📞 עזרה נוספת

אם נתקלת בבעיות:
1. ✅ בדוק את ההוראות לעיל
2. ✅ בדוק את היומן (Logs) ב-Apps Script
3. ✅ ודא שכל השלבים בוצעו בסדר
4. ✅ ודא שהטריגר מוגדר (⚙️ → Triggers)

---

**🎉 בהצלחה עם השימוש בכלי!**

